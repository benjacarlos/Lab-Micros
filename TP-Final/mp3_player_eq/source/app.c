/********************************************************************************
  @file     App.c
  @brief    Application functions
  @author   N. Magliola, G. Davidov, F. Farall, J. Gayt√°n, L. Kammann, N. Trozzo
 *******************************************************************************/

/*******************************************************************************
 * INCLUDE HEADER FILES
 ******************************************************************************/

#include "audio/audio.h"
#include "board/board.h"
#include "events/events.h"
#include "display/display.h"
#include "ui/ui.h"
#include "lib/fatfs/ff.h"

/*******************************************************************************
 * CONSTANT AND MACRO DEFINITIONS USING #DEFINE
 ******************************************************************************/

/*******************************************************************************
 * FUNCTION PROTOTYPES FOR PRIVATE FUNCTIONS WITH FILE LEVEL SCOPE
 ******************************************************************************/

/*******************************************************************************
 * VARIABLES TYPES DEFINITIONS
 ******************************************************************************/

/*******************************************************************************
 * PRIVATE VARIABLES WITH FILE LEVEL SCOPE
 ******************************************************************************/

static event_t 	event;		// Application loop events
static FATFS	fs;			// File system handler

/*******************************************************************************
 *******************************************************************************
                        GLOBAL FUNCTION DEFINITIONS
 *******************************************************************************
 ******************************************************************************/

void appInit (void)
{
	// Initialization of drivers
	boardInit();
 	eventsInit();
	displayInit();
	uiInit();
	audioInit();

	// FatFs mounting
	f_mount(&fs, "", 0);
}

void appRun (void)
{
	event = eventsGetNextEvent();
	if (event.id != EVENTS_NONE)
	{
		uiRun(event);
		audioRun(event);
	}
}

/*******************************************************************************
 *******************************************************************************
                        LOCAL FUNCTION DEFINITIONS
 *******************************************************************************
 ******************************************************************************/


/*******************************************************************************
 ******************************************************************************/
