/*
 * equalizer.c
 *
 *  Created on: Mar 8, 2019
 *      Author: Grupo 2
 */
#include "math_helper.h"
#include "equalizer.h"


/*******************************************************************************
 * STATIC VARIABLES AND CONST VARIABLES WITH FILE LEVEL SCOPE
 ******************************************************************************/

/* ----------------------------------------------------------------------
** Arm Biquad cascade filters for each band
** ------------------------------------------------------------------- */
static arm_biquad_cas_df1_32x64_ins_q31 S1;
static arm_biquad_cas_df1_32x64_ins_q31 S2;
static arm_biquad_casd_df1_inst_q31 S3;
static arm_biquad_casd_df1_inst_q31 S4;
static arm_biquad_casd_df1_inst_q31 S5;
static arm_biquad_casd_df1_inst_q31 S6;
static arm_biquad_casd_df1_inst_q31 S7;
static arm_biquad_casd_df1_inst_q31 S8;

static arm_biquad_cas_df1_32x64_ins_q31 * hpFilter [2] = {&S1, &S2};
static arm_biquad_casd_df1_inst_q31 * lpFilter [6] = {&S3, &S4, &S5, &S6, &S7, &S8};

/* ----------------------------------------------------------------------
** Q31 state buffers for Band1, Band2, Band3, Band4, Band5, Band6, Band7 and Band8
** ------------------------------------------------------------------- */

static q63_t biquadStateBandQ63 [2][4 * 2];
static q31_t biquadStateBandQ31 [6][4 * 2];
static int32_t bandGains[NUMBER_OF_BANDS]={DEFAULT_GAIN, DEFAULT_GAIN, DEFAULT_GAIN, DEFAULT_GAIN, DEFAULT_GAIN, DEFAULT_GAIN, DEFAULT_GAIN, DEFAULT_GAIN, };




/* ----------------------------------------------------------------------
** Entire coefficient table.  There are 10 coefficients per 4th order Biquad
** cascade filter.  The first 10 coefficients correspond to the -10 dB gain
** setting of band 1; the next 10 coefficient correspond to the -9 dB gain
** setting of band 1; and so on.  There are 10*21=210 coefficients in total
** for band 1 (gains = -10,...0,...10).  After this come the 210 coefficients
** for band 2.
**
** The coefficients are in Q31 format
** ------------------------------------------------------------------- */
//static q31_t coeffTable[NUMBER_OF_BANDS * COEF_PER_FILTER * GAIN_LEVELS];
static const q31_t coeffTable[NUMBER_OF_BANDS * COEF_PER_FILTER * GAIN_LEVELS] = {

		/* 80Hz band*/
		536870912,-1071816922,535036912,1070077802,-533319196,536870912,-1072283112,535465554,1071497458,-534669630,
		536870912,-1071693559,534915004,1070077802,-533319196,536870912,-1072214251,535395843,1071497458,-534669630,
		536870912,-1071561253,534784268,1070077802,-533319196,536870912,-1072142943,535323648,1071497458,-534669630,
		536870912,-1071419276,534643986,1070077802,-533319196,536870912,-1072069242,535249022,1071497458,-534669630,
		536870912,-1071266834,534493379,1070077802,-533319196,536870912,-1071993226,535172041,1071497458,-534669630,
		536870912,-1071103061,534331592,1070077802,-533319196,536870912,-1071915005,535092816,1071497458,-534669630,
		536870912,-1070927009,534157695,1070077802,-533319196,536870912,-1071834725,535011491,1071497458,-534669630,
		536870912,-1070737643,533970671,1070077802,-533319196,536870912,-1071752571,534928251,1071497458,-534669630,
		536870912,-1070533830,533769407,1070077802,-533319196,536870912,-1071668776,534843329,1071497458,-534669630,
		536870912,-1070314334,533552691,1070077802,-533319196,536870912,-1071583624,534757007,1071497458,-534669630,
		536870912,0,0,0,0,536870912,0,0,0,0,
		536870912,-1069822755,533067475,1070077802,-533319196,536870912,-1071410687,534581606,1071497458,-534669630,
		536870912,-1069547581,532795951,1070077802,-533319196,536870912,-1071323791,534493417,1071497458,-534669630,
		536870912,-1069250518,532502903,1070077802,-533319196,536870912,-1071237333,534405625,1071497458,-534669630,
		536870912,-1068929649,532186461,1070077802,-533319196,536870912,-1071151958,534318877,1071497458,-534669630,
		536870912,-1068582892,531844599,1070077802,-533319196,536870912,-1071068404,534233912,1071497458,-534669630,
		536870912,-1068207990,531475124,1070077802,-533319196,536870912,-1070987501,534151562,1071497458,-534669630,
		536870912,-1067802507,531075675,1070077802,-533319196,536870912,-1070910175,534072756,1071497458,-534669630,
		536870912,-1067363831,530643725,1070077802,-533319196,536870912,-1070837440,533998512,1071497458,-534669630,
		536870912,-1066889171,530176588,1070077802,-533319196,536870912,-1070770392,533929929,1071497458,-534669630,
		536870912,-1066375577,529671429,1070077802,-533319196,536870912,-1070710189,533868170,1071497458,-534669630,
		/* 160Hz band*/
		536870912,-1069717127,533209189,1066214306,-529791114,536870912,-1070721581,534063800,1069176170,-532477236,
		536870912,-1069468410,532966239,1066214306,-529791114,536870912,-1070585936,533924747,1069176170,-532477236,
		536870912,-1069201706,532705756,1066214306,-529791114,536870912,-1070445505,533780758,1069176170,-532477236,
		536870912,-1068915559,532426328,1066214306,-529791114,536870912,-1070300397,533631939,1069176170,-532477236,
		536870912,-1068608378,532126414,1066214306,-529791114,536870912,-1070150772,533478448,1069176170,-532477236,
		536870912,-1068278429,531804332,1066214306,-529791114,536870912,-1069996855,533320505,1069176170,-532477236,
		536870912,-1067923814,531458252,1066214306,-529791114,536870912,-1069838936,533158399,1069176170,-532477236,
		536870912,-1067542464,531086173,1066214306,-529791114,536870912,-1069677391,532992503,1069176170,-532477236,
		536870912,-1067132116,530685913,1066214306,-529791114,536870912,-1069512682,532823279,1069176170,-532477236,
		536870912,-1066690297,530255092,1066214306,-529791114,536870912,-1069345381,532651295,1069176170,-532477236,
		536870912,0,0,0,0,536870912,0,0,0,0,
		536870912,-1065701191,529291150,1066214306,-529791114,536870912,-1069005865,532301918,1069176170,-532477236,
		536870912,-1065147732,528752117,1066214306,-529791114,536870912,-1068835425,532126301,1069176170,-532477236,
		536870912,-1064550420,528170667,1066214306,-529791114,536870912,-1068665964,531951502,1069176170,-532477236,
		536870912,-1063905432,527543165,1066214306,-529791114,536870912,-1068498766,531778812,1069176170,-532477236,
		536870912,-1063208619,526865676,1066214306,-529791114,536870912,-1068335294,531609699,1069176170,-532477236,
		536870912,-1062455489,526133960,1066214306,-529791114,536870912,-1068177197,531445819,1069176170,-532477236,
		536870912,-1061641195,525343462,1066214306,-529791114,536870912,-1068026307,531289016,1069176170,-532477236,
		536870912,-1060760537,524489323,1066214306,-529791114,536870912,-1067884635,531141313,1069176170,-532477236,
		536870912,-1059807970,523566393,1066214306,-529791114,536870912,-1067754346,531004893,1069176170,-532477236,
		536870912,-1058777630,522569270,1066214306,-529791114,536870912,-1067637731,530882066,1069176170,-532477236,
		/* 320Hz band*/
		536870912,-1064996718,529572532,1057897898,-522805762,536870912,-1067291485,531270768,1064304322,-528118424,
		536870912,-1064491632,529090097,1057897898,-522805762,536870912,-1067028531,530994110,1064304322,-528118424,
		536870912,-1063950209,528573097,1057897898,-522805762,536870912,-1066756430,530707707,1064304322,-528118424,
		536870912,-1063369525,528018781,1057897898,-522805762,536870912,-1066475410,530411778,1064304322,-528118424,
		536870912,-1062746397,527424156,1057897898,-522805762,536870912,-1066185807,530106643,1064304322,-528118424,
		536870912,-1062077352,526785962,1057897898,-522805762,536870912,-1065888077,529792749,1064304322,-528118424,
		536870912,-1061358599,526100654,1057897898,-522805762,536870912,-1065582814,529470679,1064304322,-528118424,
		536870912,-1060586002,525364370,1057897898,-522805762,536870912,-1065270770,529141179,1064304322,-528118424,
		536870912,-1059755048,524572909,1057897898,-522805762,536870912,-1064952878,528805175,1064304322,-528118424,
		536870912,-1058860806,523721697,1057897898,-522805762,536870912,-1064630274,528463802,1064304322,-528118424,
		536870912,0,0,0,0,536870912,0,0,0,0,
		536870912,-1056860454,521819701,1057897898,-522805762,536870912,-1063976641,527770663,1064304322,-528118424,
		536870912,-1055742077,520757653,1057897898,-522805762,536870912,-1063649128,527422426,1064304322,-528118424,
		536870912,-1054535799,519613267,1057897898,-522805762,536870912,-1063323989,527075932,1064304322,-528118424,
		536870912,-1053234046,518379685,1057897898,-522805762,536870912,-1063003756,526733734,1064304322,-528118424,
		536870912,-1051828602,517049516,1057897898,-522805762,536870912,-1062691313,526398739,1064304322,-528118424,
		536870912,-1050310582,515614838,1057897898,-522805762,536870912,-1062389897,526074222,1064304322,-528118424,
		536870912,-1048670416,514067194,1057897898,-522805762,536870912,-1062103110,525763824,1064304322,-528118424,
		536870912,-1046897846,512397625,1057897898,-522805762,536870912,-1061834890,525471538,1064304322,-528118424,
		536870912,-1044981949,510596717,1057897898,-522805762,536870912,-1061589479,525201671,1064304322,-528118424,
		536870912,-1042911184,508654681,1057897898,-522805762,536870912,-1061371349,524958774,1064304322,-528118424,
		/* 640Hz band*/
		536870912,-1053500912,522374087,1038971236,-509117552,536870912,-1059213773,525724302,1053654553,-519500012,
		536870912,-1052462660,521423100,1038971236,-509117552,536870912,-1058721412,525176571,1053654553,-519500012,
		536870912,-1051350515,520404977,1038971236,-509117552,536870912,-1058212424,524609844,1053654553,-519500012,
		536870912,-1050158635,519314517,1038971236,-509117552,536870912,-1057687320,524024581,1053654553,-519500012,
		536870912,-1048880665,518146081,1038971236,-509117552,536870912,-1057146814,523421450,1053654553,-519500012,
		536870912,-1047509687,516893558,1038971236,-509117552,536870912,-1056591856,522801362,1053654553,-519500012,
		536870912,-1046038167,515550323,1038971236,-509117552,536870912,-1056023665,522165503,1053654553,-519500012,
		536870912,-1044457902,514109198,1038971236,-509117552,536870912,-1055443765,521515374,1053654553,-519500012,
		536870912,-1042759957,512562413,1038971236,-509117552,536870912,-1054854031,520852834,1053654553,-519500012,
		536870912,-1040934601,510901560,1038971236,-509117552,536870912,-1054256726,520180142,1053654553,-519500012,
		536870912,0,0,0,0,536870912,0,0,0,0,
		536870912,-1036858331,507200583,1038971236,-509117552,536870912,-1053050701,518815655,1053654553,-519500012,
		536870912,-1034583347,505140095,1038971236,-509117552,536870912,-1052448894,518130838,1053654553,-519500012,
		536870912,-1032132666,502924748,1038971236,-509117552,536870912,-1051853441,517449930,1053654553,-519500012,
		536870912,-1029491525,500542404,1038971236,-509117552,536870912,-1051269272,516777947,1053654553,-519500012,
		536870912,-1026643957,497980130,1038971236,-509117552,536870912,-1050701977,516120589,1053654553,-519500012,
		536870912,-1023572746,495224218,1038971236,-509117552,536870912,-1050157822,515484263,1053654553,-519500012,
		536870912,-1020259406,492260249,1038971236,-509117552,536870912,-1049643744,514876084,1053654553,-519500012,
		536870912,-1016684192,489073187,1038971236,-509117552,536870912,-1049167313,514303838,1053654553,-519500012,
		536870912,-1012826154,485647538,1038971236,-509117552,536870912,-1048736653,513775912,1053654553,-519500012,
		536870912,-1008663248,481967562,1038971236,-509117552,536870912,-1048360302,513301156,1053654553,-519500012,
		/* 1280Hz band*/
		536870912,-1022534048,508274418,992463053,-482863560,536870912,-1038283068,514771893,1028827019,-502624281,
		536870912,-1020365229,506428067,992463053,-482863560,536870912,-1037433905,513697201,1028827019,-502624281,
		536870912,-1018045662,504455396,992463053,-482863560,536870912,-1036557978,512586370,1028827019,-502624281,
		536870912,-1015563875,502347180,992463053,-482863560,536870912,-1035656480,511440424,1028827019,-502624281,
		536870912,-1012907442,500093503,992463053,-482863560,536870912,-1034730991,510260797,1028827019,-502624281,
		536870912,-1010062897,497683714,992463053,-482863560,536870912,-1033783536,509049396,1028827019,-502624281,
		536870912,-1007015652,495106381,992463053,-482863560,536870912,-1032816646,507808661,1028827019,-502624281,
		536870912,-1003749897,492349255,992463053,-482863560,536870912,-1031833426,506541647,1028827019,-502624281,
		536870912,-1000248503,489399227,992463053,-482863560,536870912,-1030837628,505252094,1028827019,-502624281,
		536870912,-996492917,486242298,992463053,-482863560,536870912,-1029833731,503944514,1028827019,-502624281,
		536870912,0,0,0,0,536870912,0,0,0,0,
		536870912,-988137184,479247181,992463053,-482863560,536870912,-1027823674,501297725,1028827019,-502624281,
		536870912,-983491836,475376419,992463053,-482863560,536870912,-1026830850,499972219,1028827019,-502624281,
		536870912,-978501683,471233660,992463053,-482863560,536870912,-1025856762,498656277,1028827019,-502624281,
		536870912,-973139465,466800484,992463053,-482863560,536870912,-1024910751,497359627,1028827019,-502624281,
		536870912,-967375916,462057790,992463053,-482863560,536870912,-1024003333,496093278,1028827019,-502624281,
		536870912,-961179739,456985968,992463053,-482863560,536870912,-1023146225,494869558,1028827019,-502624281,
		536870912,-954517618,451565152,992463053,-482863560,536870912,-1022352317,493702103,1028827019,-502624281,
		536870912,-947354305,445775569,992463053,-482863560,536870912,-1021635590,492605788,1028827019,-502624281,
		536870912,-939652797,439597987,992463053,-482863560,536870912,-1021010947,491596581,1028827019,-502624281,
		536870912,-931374623,433014295,992463053,-482863560,536870912,-1020493940,490691283,1028827019,-502624281,
		/* 2500Hz band*/
		536870912,-936047970,482479929,875686579,-436894827,536870912,-981563302,494290899,969273431,-471552808,
		536870912,-931608967,479081236,875686579,-436894827,536870912,-980416389,492258814,969273431,-471552808,
		536870912,-926876941,475465058,875686579,-436894827,536870912,-979240047,490162370,969273431,-471552808,
		536870912,-921831475,471617561,875686579,-436894827,536870912,-978037073,488003941,969273431,-471552808,
		536870912,-916450678,467524171,875686579,-436894827,536870912,-976810945,485786686,969273431,-471552808,
		536870912,-910711084,463169573,875686579,-436894827,536870912,-975565910,483514659,969273431,-471552808,
		536870912,-904587549,458537737,875686579,-436894827,536870912,-974307093,481192921,969273431,-471552808,
		536870912,-898053148,453611946,875686579,-436894827,536870912,-973040602,478827671,969273431,-471552808,
		536870912,-891079070,448374855,875686579,-436894827,536870912,-971773645,476426382,969273431,-471552808,
		536870912,-883634511,442808583,875686579,-436894827,536870912,-970514658,473997942,969273431,-471552808,
		536870912,0,0,0,0,536870912,0,0,0,0,
		536870912,-867200212,430615041,875686579,-436894827,536870912,-968061237,469103163,969273431,-471552808,
		536870912,-858138102,423950653,875686579,-436894827,536870912,-966890960,466663066,969273431,-471552808,
		536870912,-848460664,416883366,875686579,-436894827,536870912,-965777204,464248598,969273431,-471552808,
		536870912,-838126028,409395537,875686579,-436894827,536870912,-964736383,461877988,969273431,-471552808,
		536870912,-827090106,401470655,875686579,-436894827,536870912,-963786774,459571703,969273431,-471552808,
		536870912,-815306725,393093950,875686579,-436894827,536870912,-962948500,457352485,969273431,-471552808,
		536870912,-802727875,384253126,875686579,-436894827,536870912,-962243442,455245308,969273431,-471552808,
		536870912,-789304098,374939248,875686579,-436894827,536870912,-961695030,453277219,969273431,-471552808,
		536870912,-774985045,365147795,875686579,-436894827,536870912,-961327878,451477032,969273431,-471552808,
		536870912,-759720261,354879851,875686579,-436894827,536870912,-961167239,449874824,969273431,-471552808,
		/* 5000Hz band*/
		536870912,-666051300,434000610,553291775,-358845362,536870912,-805166254,453012617,805433442,-410709606,
		536870912,-657390917,428057120,553291775,-358845362,536870912,-804978046,449149634,805433442,-410709606,
		536870912,-648227976,421794259,553291775,-358845362,536870912,-804814587,445179530,805433442,-410709606,
		536870912,-638535076,415199499,553291775,-358845362,536870912,-804682366,441108661,805433442,-410709606,
		536870912,-628283611,408260731,553291775,-358845362,536870912,-804588922,436944970,805433442,-410709606,
		536870912,-617443767,400966491,553291775,-358845362,536870912,-804542980,432698181,805433442,-410709606,
		536870912,-605984517,393306224,553291775,-358845362,536870912,-804554597,428380004,805433442,-410709606,
		536870912,-593873639,385270608,553291775,-358845362,536870912,-804635321,424004349,805433442,-410709606,
		536870912,-581077741,376851931,553291775,-358845362,536870912,-804798354,419587565,805433442,-410709606,
		536870912,-567562308,368044539,553291775,-358845362,536870912,-805058723,415148671,805433442,-410709606,
		536870912,0,0,0,0,536870912,0,0,0,0,
		536870912,-538229636,349254520,553291775,-358845362,536870912,-805941668,406295462,805433442,-410709606,
		536870912,-522338600,339276034,553291775,-358845362,536870912,-806604829,401934712,805433442,-410709606,
		536870912,-505580810,328918630,553291775,-358845362,536870912,-807446703,397659395,805433442,-410709606,
		536870912,-487918156,318196647,553291775,-358845362,536870912,-808493431,393505246,805433442,-410709606,
		536870912,-469312698,307131047,553291775,-358845362,536870912,-809773429,389511739,805433442,-410709606,
		536870912,-449727245,295750509,553291775,-358845362,536870912,-811317155,385721989,805433442,-410709606,
		536870912,-429126130,284092575,553291775,-358845362,536870912,-813156677,382182471,805433442,-410709606,
		536870912,-407476226,272204789,553291775,-358845362,536870912,-815325008,378942487,805433442,-410709606,
		536870912,-384748252,260145757,553291775,-358845362,536870912,-817855137,376053312,805433442,-410709606,
		536870912,-360918390,247985987,553291775,-358845362,536870912,-820778725,373566954,805433442,-410709606,
		/* 10000Hz band*/
		536870912,56137600,356573763,-186040984,-268643972,536870912,-308325181,365412106,400006857,-289423789,
		536870912,66859881,348331346,-186040984,-268643972,536870912,-315840368,358022248,400006857,-289423789,
		536870912,78043739,339888202,-186040984,-268643972,536870912,-323680563,350500448,400006857,-289423789,
		536870912,89704048,331264755,-186040984,-268643972,536870912,-331859397,342870461,400006857,-289423789,
		536870912,101856225,322485920,-186040984,-268643972,536870912,-340391653,335160295,400006857,-289423789,
		536870912,114516296,313581626,-186040984,-268643972,536870912,-349293399,327402635,400006857,-289423789,
		536870912,127700950,304587350,-186040984,-268643972,536870912,-358582105,319635259,400006857,-289423789,
		536870912,141427550,295544661,-186040984,-268643972,536870912,-368276716,311901446,400006857,-289423789,
		536870912,155714083,286501754,-186040984,-268643972,536870912,-378397657,304250342,400006857,-289423789,
		536870912,170579014,277513928,-186040984,-268643972,536870912,-388966730,296737248,400006857,-289423789,
		536870912,0,0,0,0,536870912,0,0,0,0,
		536870912,202118319,259962391,-186040984,-268643972,536870912,-411541607,282377885,400006857,-289423789,
		536870912,218828269,251547373,-186040984,-268643972,536870912,-423594452,275673438,400006857,-289423789,
		536870912,236185918,243484394,-186040984,-268643972,536870912,-436187674,269389640,400006857,-289423789,
		536870912,254202736,235865332,-186040984,-268643972,536870912,-449340898,263609786,400006857,-289423789,
		536870912,272884725,228786949,-186040984,-268643972,536870912,-463069201,258419473,400006857,-289423789,
		536870912,292230230,222348621,-186040984,-268643972,536870912,-477380872,253904119,400006857,-289423789,
		536870912,312227524,216649274,-186040984,-268643972,536870912,-492274924,250145790,400006857,-289423789,
		536870912,332852407,211783540,-186040984,-268643972,536870912,-507738604,247219429,400006857,-289423789,
		536870912,354066129,207837353,-186040984,-268643972,536870912,-523745218,245188748,400006857,-289423789,
		536870912,375814044,204883326,-186040984,-268643972,536870912,-540252661,244102159,400006857,-289423789,


		/*
		//80Hz band
		0.07982071085001121700,-0.15949881800025528000,0.07967825120735941300,0.49973660685725063000,-0.24973675091436595000,0.25387895230927310000,-0.49999999999999994000,0.24625272190812073000,0.48590011506348246000,-0.23630115115498895000,
		0.08955754925860820400,-0.17895407723002280000,0.08939669198888305900,0.49971970119341008000,-0.24971986521087855000,0.25384643938805140000,-0.49999999999999994000,0.24628331658144934000,0.48682005498328307000,-0.23717292295835202000,
		0.10048126219700776000,-0.20078036262832577000,0.10029928800408007000,0.49970119870020940000,-0.24970138627297148000,0.25380442470597125000,-0.50000000000000000000,0.24632287522207663000,0.48771337911795198000,-0.23802247473562654000,
		0.11273775130960420000,-0.22526889388411533000,0.11253135838286045000,0.49968072315647571000,-0.24968093896482504000,0.25374968853677071000,-0.50000000000000000000,0.24637445030485397000,0.48858811577675887000,-0.23885723028655245000,
		0.12648872018762625000,-0.25274227057960807000,0.12625380078449666000,0.49965771474093224000,-0.24965796513344701000,0.25367757400580848000,-0.50000000000000000000,0.24644246688277746000,0.48945453478841772000,-0.23968687146335377000,
		0.14191546476502337000,-0.28356189228070133000,0.14164672158825761000,0.49963129211508828000,-0.24963158618766787000,0.25358102934061649000,-0.50000000000000000000,0.24653364431862690000,0.49032681824830382000,-0.24052497963634106000,
		0.15922260342735076000,-0.31813508639967125000,0.15891283479488930000,0.49959995951531200000,-0.24960031133788085000,0.25344864983004889000,-0.50000000000000000000,0.24665888623128560000,0.49122654481128025000,-0.24139246699009270000,
		0.00111698880411224250,-0.00220522105997436170,0.00108866364710004950,0.49956088965887457000,-0.24956132360284211000,0.25025344715801745000,-0.50000000000000000000,0.24974716075898412000,0.49219109102686082000,-0.24232586279118523000,
		0.24958699238200421000,-0.49330909617402707000,0.24380495796128243000,0.49329897249195676000,-0.24340233849968551000,0.25002213397247885000,-0.49950599402662710000,0.24948456740257000000,0.49950775606056030000,-0.24950832304352846000,
		0.24982712784229741000,-0.49478910755175287000,0.24502364123954523000,0.49478617169013162000,-0.24485474817699485000,0.25001134547109766000,-0.49942175996971488000,0.24941136762562374000,0.49942128155523857000,-0.24942213857570844000,
		0.25000000000000000000,0.00000000000000000000,0.00000000000000000000,-0.00000000000000000000,-0.00000000000000000000,0.25000000000000000000,0.00000000000000000000,0.00000000000000000000,-0.00000000000000000000,-0.00000000000000000000,
		0.22363111400039437000,-0.44259833121553716000,0.21902856055888847000,0.49513148545381880000,-0.24519318965113712000,0.24924624248328608000,-0.49791551121112820000,0.24867012316228304000,0.49939909618846678000,-0.24940004927087861000,
		0.19951663341610235000,-0.39368540101213406000,0.19425126054778202000,0.49412540642452990000,-0.24420839769774649000,0.24921767870347825000,-0.49794465387008302000,0.24872754037575917000,0.49946177371186562000,-0.24946248099734949000,
		0.24399010060591200000,-0.48755164688068831000,0.24356196978646835000,0.49356382360388390000,-0.24366037587752271000,0.18182015917241920000,-0.35796105007430440000,0.17623890779620752000,0.49949361896952832000,-0.24949422626974349000,
		0.24843775423990089000,-0.49647796784430059000,0.24804056322847867000,0.49951307093674580000,-0.24951362334359659000,0.15933038947195874000,-0.31306926681307118000,0.15384462312263675000,0.49319655118632322000,-0.24330262401548833000,
		0.24842416880854118000,-0.49648195382587534000,0.24805807723645251000,0.49952606075257777000,-0.24952657879481624000,0.14218848953496308000,-0.27887531865617143000,0.13679953419507954000,0.49293908269992992000,-0.24305213695700659000,
		0.24841275497325385000,-0.49648539781430545000,0.24807289164305618000,0.49953519611216018000,-0.24953569100315601000,0.12690079923097825000,-0.24844868662560912000,0.12166582223324737000,0.49275147986529499000,-0.24286978051628508000,
		0.24840269831857914000,-0.49648815969154336000,0.24808567580181501000,0.49954183770316601000,-0.24954231626542345000,0.11326584907827174000,-0.22136139114472747000,0.10821746799999510000,0.49261144211938274000,-0.24273374654663726000,
		0.24839357705635029000,-0.49649027281559405000,0.24809688212667155000,0.49954677677781212000,-0.24954724346373433000,0.10110422799905212000,-0.19723953872308325000,0.09626031421921656100,0.49250520413428844000,-0.24263059588838742000,
		0.24838547883911266000,-0.49649246907701694000,0.24810715319646345000,0.49955050883696683000,-0.24955096669097876000,0.09025607805045846000,-0.17575387551205132000,0.08562519137969493200,0.49242368857333485000,-0.24255147839884117000,
		0.24837758876053259000,-0.49649349370009616000,0.24811604806160792000,0.49955336247244425000,-0.24955381366209733000,0.08057916461448202900,-0.15661370143359618000,0.07616379743199984400,0.49236062644423584000,-0.24249028884456106000,
		// 160Hz band
		0.24554275335510919000,-0.48714391252932288000,0.24181883002148111000,0.49192756640619295000,-0.24227393963058208000,0.25114927545893179000,-0.50000000000000000000,0.24892630632617041000,0.49707104681587511000,-0.24711873483700394000,
		0.24590376383038198000,-0.48772553180433126000,0.24204331855625877000,0.49221439078089846000,-0.24255062146737089000,0.25116922700204730000,-0.50000000000000000000,0.24890512005863130000,0.49708885201481234000,-0.24713800852568490000,
		0.24628788474404850000,-0.48834732037746409000,0.24228507331388577000,0.49249029729996463000,-0.24281698004877736000,0.25118908520546757000,-0.50000000000000000000,0.24888400842530134000,0.49710894280460716000,-0.24715956598978428000,
		0.24669425013294385000,-0.48900727286443924000,0.24254296707861370000,0.49275566338683685000,-0.24307335233492774000,0.25120881080368135000,-0.50000000000000000000,0.24886301097497518000,0.49713118580339594000,-0.24718327210672963000,
		0.24712170067871922000,-0.48970279068042932000,0.24281557349025440000,0.49301086262230265000,-0.24332007423498192000,0.25122836186940045000,-0.50000000000000000000,0.24884216996747185000,0.49715544461901318000,-0.24720898885612441000,
		0.24756837610421534000,-0.49042987520320014000,0.24310076747439618000,0.49325626346795259000,-0.24355747917942569000,0.25124769375941208000,-0.50000000000000000000,0.24882153043258343000,0.49718158131421175000,-0.24723657678324490000,
		0.24803208182034139000,-0.49118385594197989000,0.24339608714810831000,0.49349222808856807000,-0.24378589678898258000,0.25104814414714116000,-0.49956497445679660000,0.24858467052378849000,0.49720945776808567000,-0.24726589636030930000,
		0.24851026632547102000,-0.49195934702183325000,0.24369871294068757000,0.49371911132425356000,-0.24400565169351027000,0.25079882243569823000,-0.49903160913463063000,0.24829921542898459000,0.49723893688294485000,-0.24729680919318339000,
		0.24899986341899558000,-0.49274993631961417000,0.24400531440400353000,0.49393725992851367000,-0.24421706262526074000,0.25053861216234879000,-0.49847739263413676000,0.24800378173789706000,0.49726988352056833000,-0.24732917894937043000,
		0.24949761081787258000,-0.49354881813651619000,0.24431236464561662000,0.49414701174982534000,-0.24442044144902852000,0.25027108384363317000,-0.49790954082512934000,0.24770201659429933000,0.49730216549035455000,-0.24736287235091345000,
		0.25000000000000000000,-0.49423722773516821000,0.24436567416228125000,0.49423722773516821000,-0.24436567416228125000,0.25000000000000000000,-0.49423722773516821000,0.24436567416228125000,0.49423722773516821000,-0.24436567416228125000,
		0.22877334814362696000,-0.45219066542321046000,0.22366753099118342000,0.49454262960634154000,-0.24480431280057691000,0.24371235167787264000,-0.48479472097341775000,0.24114154934184334000,0.49737022469528602000,-0.24743371546275456000,
		0.20934995282796315000,-0.41362296825779560000,0.20450732215497081000,0.49472912308498229000,-0.24498538979461607000,0.23758191962789368000,-0.47256933400689949000,0.23504376446666611000,0.49740575748116223000,-0.24747061900714409000,
		0.19157750573203383000,-0.37834190352034741000,0.18698397654536389000,0.49490847429971851000,-0.24515960300345224000,0.23160381187240370000,-0.46064973277219451000,0.22909953469023839000,0.49744213737746557000,-0.24750835452470593000,
		0.17531654261513108000,-0.34606940493721461000,0.17095880224671836000,0.49508097132185891000,-0.24532722275934760000,0.22577314311806704000,-0.44902616828167558000,0.22330399443754312000,0.49747925457629960000,-0.24754681155229338000,
		0.16043940857489186000,-0.31655097274670724000,0.15630487165422655000,0.49524689189834747000,-0.24548851037405187000,0.22008498387085376000,-0.43768880121759962000,0.21765223205440168000,0.49751700456445019000,-0.24758588499059464000,
		0.14682928915631585000,-0.28955373801389039000,0.14290605414242466000,0.49540650348234760000,-0.24564371806852917000,0.21453429980988195000,-0.42662758084198965000,0.21213922933438872000,0.49755528823321871000,-0.24762547521084696000,
		0.13437930736573953000,-0.26486465898224948000,0.13065611489956655000,0.49556006331547664000,-0.24579308896032895000,0.20911587953646998000,-0.41583210066278359000,0.20675978941918385000,0.49759401193281738000,-0.24766548810705921000,
		0.12299168522867036000,-0.24228884649432186000,0.11945787831288253000,0.49570781860607094000,-0.24593685715680905000,0.20382431341890739000,-0.40529155584692883000,0.20150851537190767000,0.49763308742702206000,-0.24770583504500915000,
		0.11257588908944233000,-0.22164589065932791000,0.10922140744376968000,0.49585000673514268000,-0.24607524788126200000,0.19865585428099874000,-0.39499844220187258000,0.19638164883549394000,0.49767243181651050000,-0.24774643278137856000,
		0.10302511537898029000,-0.20272357714692260000,0.09984120233351989600,0.49598685551865035000,-0.24620847766404266000,0.19365187094024786000,-0.38503495282725719000,0.19142002138521236000,0.49771196740237528000,-0.24778720332044429000,
		// 320Hz band
		0.24355094002509950000,-0.47891716928931100000,0.23622300573287386000,0.48343329633612642000,-0.23479665980914793000,0.25184086618378571000,-0.49894178626821173000,0.24740275424312255000,0.49408088426619823000,-0.24427056545520393000,
		0.24411640407245880000,-0.47975930935047134000,0.23651545420917289000,0.48400848632758753000,-0.23533268835888205000,0.25174133246188746000,-0.49866817833249116000,0.24722358527025615000,0.49411316941275540000,-0.24430869822171430000,
		0.24470285512732862000,-0.48063095620218843000,0.23681723792805057000,0.48456199850261034000,-0.23584930870425475000,0.25161810311935157000,-0.49834812978498033000,0.24702157495189878000,0.49414997900192004000,-0.24435134952277515000,
		0.24530983605096776000,-0.48153062225313509000,0.23712737577703069000,0.48509457218148611000,-0.23634710782884327000,0.25147222668955993000,-0.49798389181487385000,0.24679792990607277000,0.49419105379186312000,-0.24439825321689668000,
		0.24593646015644852000,-0.48245595117438395000,0.23744444974766921000,0.48560693977007452000,-0.23682667608986721000,0.25130519007287777000,-0.49757859189153503000,0.24655429530517389000,0.49423612836088243000,-0.24444913741724991000,
		0.24658130409386950000,-0.48340350985664465000,0.23776650378887609000,0.48609982413311004000,-0.23728860406008268000,0.25111902147188470000,-0.49713643694144333000,0.24629285519306646000,0.49428493406410789000,-0.24450372745165258000,
		0.24724250125345151000,-0.48436897441506049000,0.23809113692868611000,0.48657393629835799000,-0.23773347969507097000,0.25091618333616461000,-0.49666250067212991000,0.24601622670277340000,0.49433720165320866000,-0.24456174847681955000,
		0.24791777459611353000,-0.48534719735002091000,0.23841553792464329000,0.48702997346034149000,-0.23816188579820988000,0.25069952932137196000,-0.49616263772609492000,0.24572741716873098000,0.49439266359031570000,-0.24462292778412914000,
		0.24860445208233281000,-0.48633224086435589000,0.23873650341631267000,0.48746861729321345000,-0.23857439780069856000,0.25047227916003545000,-0.49564343331831578000,0.24542979883527377000,0.49445105604653672000,-0.24468699678613043000,
		0.24929958772802022000,-0.48731761706272275000,0.23905055777872633000,0.48789053258325793000,-0.23897158187370338000,0.25023788769201982000,-0.49511194343049825000,0.24512697985538129000,0.49451212057453287000,-0.24475369267229927000,
		0.25000000000000000000,-0.48835174906520556000,0.23885974655547060000,0.48835174906520556000,-0.23885974655547060000,0.25000000000000000000,-0.48835174906520556000,0.23885974655547060000,0.48835174906520556000,-0.23885974655547060000,
		0.22895504454522383000,-0.44681999448370269000,0.21885499669232733000,0.48868674583845184000,-0.23972217519218533000,0.24374470614022856000,-0.48213884604831703000,0.23862966758794696000,0.49464126715284196000,-0.24489395082839424000,
		0.20968289388526093000,-0.40885532140894915000,0.20009988055091352000,0.48906228025165199000,-0.24007665733321754000,0.23764488076664131000,-0.47001504903670410000,0.23259444870580706000,0.49470887055887980000,-0.24496702754723015000,
		0.19203531832272180000,-0.37410782394431824000,0.18294197420605088000,0.48942355801255250000,-0.24041795542141559000,0.23169557602521837000,-0.45819437189320494000,0.22671220064810321000,0.49477819031976966000,-0.24504176158054616000,
		0.17587642296605943000,-0.34230753369857242000,0.16724685611205678000,0.48977114771900832000,-0.24074657039329911000,0.22589187437426114000,-0.44666702821762222000,0.22097804705485558000,0.49484901100071560000,-0.24511793483337635000,
		0.16108167515856792000,-0.31320709586216744000,0.15289138335169108000,0.49010559786095786000,-0.24106298798996642000,0.22022881503841613000,-0.43542314128169318000,0.21538706467725272000,0.49492112746693939000,-0.24519533979246846000,
		0.14753699032858447000,-0.28657994550554999000,0.13976278007944853000,0.49042743689618629000,-0.24136767846230833000,0.21470133226074462000,-0.42445262084168356000,0.20993422189365063000,0.49499434506924511000,-0.24527377969442316000,
		0.13513661883337905000,-0.26221616119674690000,0.12775659609282916000,0.49073717345136292000,-0.24166109642724251000,0.20930615356538113000,-0.41374891438142075000,0.20461623327462106000,0.49506847969822465000,-0.24535306856160466000,
		0.12377682734731763000,-0.23991018731100183000,0.11677071665397702000,0.49103529661776157000,-0.24194368084236234000,0.20405148819647770000,-0.40332815443025516000,0.19944102605159730000,0.49514335773778334000,-0.24543303113825354000,
		0.11337710545662849000,-0.21950192478504266000,0.10672535610180151000,0.49132227632659831000,-0.24221585508304236000,0.19892216559261836000,-0.39316024682970713000,0.19439366129355432000,0.49521881593310840000,-0.24551350274198766000,
		0.10385745367738215000,-0.20083260472108211000,0.09754153287865942300,0.49159856377545424000,-0.24247802709098620000,0.19391274303984790000,-0.38323431820691750000,0.18946870156577969000,0.49529470120169533000,-0.24559432906099762000,
		// 640Hz band
		0.23958823743715729000,-0.46168631794182285000,0.22541423209733805000,0.46531615110067037000,-0.22059304660192339000,0.25126354751341029000,-0.49255769947896710000,0.24248836574088262000,0.48792109431731284000,-0.23867157230424818000,
		0.24055525938258668000,-0.46301040165365376000,0.22583623301031855000,0.46646593481082388000,-0.22159716242749011000,0.25121539250953911000,-0.49232350251904144000,0.24228223444650296000,0.48797265691395109000,-0.23874631607648317000,
		0.24154038844063672000,-0.46434436936721002000,0.22625317136200773000,0.46757337493481499000,-0.22256718235696740000,0.25114558412390636000,-0.49204796105956083000,0.24205603882146595000,0.48803307692170916000,-0.23882990371254906000,
		0.24254382132881461000,-0.46568736933345095000,0.22666419786450964000,0.46863986429937221000,-0.22350396107896928000,0.25105491180790995000,-0.49173295451536464000,0.24181088313696400000,0.48810186473776374000,-0.23892181850927999000,
		0.24356526336310264000,-0.46703754775326023000,0.22706796077416230000,0.46966678646972004000,-0.22440837872781591000,0.25094467527124109000,-0.49138137796034043000,0.24154837998016468000,0.48817851799079015000,-0.23902153265011536000,
		0.24460395611092564000,-0.46839210587607694000,0.22746263644722364000,0.47065551044579962000,-0.22528133402393544000,0.25081664412681354000,-0.49099706186165365000,0.24127060999709984000,0.48826252720127122000,-0.23912851287515632000,
		0.24565867971896391000,-0.46974730901484785000,0.22784593680872581000,0.47160738596203855000,-0.22612373794678919000,0.25067304322356776000,-0.49058474214922898000,0.24098010640897155000,0.48835338084736174000,-0.23924222553384772000,
		0.24672779801840342000,-0.47109857805402988000,0.22821515722087413000,0.47252373940387632000,-0.22693650798277590000,0.25051649427379941000,-0.49014994474295903000,0.24067979751173310000,0.48845056982160401000,-0.23936214101016692000,
		0.24780930476992705000,-0.47244058329740296000,0.22856722565366239000,0.47340587032878101000,-0.22772056296154466000,0.25034995749585742000,-0.48969887020524516000,0.24037294931341099000,0.48855359128925469000,-0.23948773753602343000,
		0.24890088479352226000,-0.47376736680518949000,0.22889876579047805000,0.47425504857827383000,-0.22847681849181389000,0.25017665971884168000,-0.48923825199207771000,0.24006309528192235000,0.48866195196047468000,-0.23961850440629140000,
		0.25000000000000000000,-0.47623999636308934000,0.22822675652958166000,0.47623999636308934000,-0.22822675652958166000,0.25000000000000000000,-0.47623999636308934000,0.22822675652958166000,0.47623999636308934000,-0.22822675652958166000,
		0.22932171839972229000,-0.43502793079885410000,0.20957878652417683000,0.47585946429852738000,-0.22990955413863995000,0.24380444376371255000,-0.47655182154485420000,0.23368022472907429000,0.48889278134698122000,-0.23989357715447093000,
		0.21035559239494772000,-0.39833428918503655000,0.19160917568915670000,0.47661707430225908000,-0.23058781616949056000,0.23776112170798749000,-0.46463619951758350000,0.22776349244748073000,0.48901433327932087000,-0.24003693841005602000,
		0.19296142513275047000,-0.36471541665762791000,0.17515996797991340000,0.47734647437152178000,-0.23124183721283531000,0.23186496341827098000,-0.45301829401338306000,0.22199877627630799000,0.48913939395857520000,-0.24018358372896104000,
		0.17701036416142196000,-0.33391758052161291000,0.16010498079823518000,0.47804876012540642000,-0.23187246738980999000,0.22611094871723694000,-0.44168818501043300000,0.21638114635442743000,0.48926754931498462000,-0.24033308818346114000,
		0.16238404765846526000,-0.30570778735584092000,0.14632837952287256000,0.47872499010563369000,-0.23248053717492342000,0.22049403367420603000,-0.43063589645822364000,0.21090564148135540000,0.48939840453079697000,-0.24048504719170982000,
		0.14897160283126643000,-0.27986805590802538000,0.13372190347139937000,0.47937618577505975000,-0.23306685612594372000,0.21501225243255417000,-0.41985745096953181000,0.20557023245992292000,0.48953158443117928000,-0.24063907683948912000,
		0.13667303630520050000,-0.25620173274980934000,0.12218785994760833000,0.48000333175054632000,-0.23363221192624767000,0.20966129002036377000,-0.40934426648905864000,0.20037062673066749000,0.48966673363843238000,-0.24079481396694960000,
		0.12539708019346954000,-0.23452934397207037000,0.11163709925772831000,0.48060737622908961000,-0.23417736969655520000,0.20443596640766212000,-0.39908605487767312000,0.19530168869022924000,0.48980351653004872000,-0.24095191606275454000,
		0.11505557481572760000,-0.21467802504638001000,0.10198395560242676000,0.48118923157401772000,-0.23470307154151199000,0.19933853658282710000,-0.38908702128678224000,0.19036536504507481000,0.48994161703330191000,-0.24111006099814897000,
		0.10557381622048488000,-0.19650080728290217000,0.09315539904587326300,0.48174977503098720000,-0.23521003629850998000,0.19436087004168315000,-0.37933107361281226000,0.18555365778908064000,0.49008073828618287000,-0.24126894663076009000,
		// 1280Hz band
		0.04689546897444399300,-0.08593873646368906100,0.04154982138369882300,0.47490909447646656000,-0.22784997559416598000,0.26140269138889921000,-0.50000000000000000000,0.24348446214229569000,0.42545679266635894000,-0.19517415220034781000,
		0.23355735071529252000,-0.42694741669296649000,0.20605259539944967000,0.42770797606942912000,-0.19692494674112040000,0.25034374288694428000,-0.47861809533833322000,0.23287572733411768000,0.47496243992620057000,-0.22799439776329106000,
		0.23530811381793124000,-0.42904056246609823000,0.20667853785206272000,0.42988079195494977000,-0.19862440081445060000,0.25036111645673109000,-0.47842510191890575000,0.23258560013645485000,0.47503270788209639000,-0.22815575784316108000,
		0.23707753557277278000,-0.43111033325171333000,0.20727522314249822000,0.43197756572906149000,-0.20027317646123058000,0.25036105628471017000,-0.47820195723925130000,0.23228140643424031000,0.47511902572106468000,-0.22833307873608880000,
		0.23886639801813056000,-0.43315536903292751000,0.20784133959222859000,0.43400062870025335000,-0.20187203842950172000,0.25034443761403197000,-0.47795096926233321000,0.23196463771141676000,0.47522049418439971000,-0.22852536271809012000,
		0.24067505293483729000,-0.43517339125243842000,0.20837512508134687000,0.43595230686104502000,-0.20342184014255113000,0.25031260217596862000,-0.47767536631439245000,0.23163724973484892000,0.47533619783797720000,-0.22873160195040926000,
		0.24250342986321166000,-0.43716122367523247000,0.20887438356312729000,0.43783491083401738000,-0.20492351033913811000,0.25026733248601379000,-0.47737924607247328000,0.23130163619315083000,0.47546521446796136000,-0.22895078784408371000,
		0.04565665195477662500,-0.08204799092168990600,0.03911423373852307400,0.47560662337974430000,-0.22918191926030573000,0.26223837640137687000,-0.50000000000000000000,0.24206280084270987000,0.43965072700806396000,-0.20637804052835465000,
		0.04508221867043821200,-0.08075225153482534800,0.03840667871171642200,0.47575951260726268000,-0.22942400956824135000,0.26234696300064897000,-0.50000000000000000000,0.24186610314036597000,0.44140200985169797000,-0.20778647335255784000,
		0.23855815499382632000,-0.45448019063721812000,0.21967055478518954000,0.47592298506871145000,-0.22967609260910182000,0.26007733737333605000,-0.46428027765471952000,0.22028151385025083000,0.44309097536145553000,-0.20914989191182801000,
		0.25000000000000000000,-0.45082739354043633000,0.20842962660024791000,0.45082739354043633000,-0.20842962660024791000,0.25000000000000000000,-0.45082739354043633000,0.20842962660024791000,0.45082739354043633000,-0.20842962660024791000,
		0.23926384489434180000,-0.45548465312454811000,0.21981273999188178000,0.47627819582293496000,-0.23020650330618242000,0.23452339889225024000,-0.41566080624098428000,0.19620217411640617000,0.44629059412070082000,-0.21174616373246069000,
		0.16316292001363425000,-0.31050524520505857000,0.14973396528956232000,0.44780544256894916000,-0.21298130307469762000,0.28318856101719542000,-0.50000000000000000000,0.23537100955019347000,0.47646825627516165000,-0.23048304083072804000,
		0.15984254136039713000,-0.30408868547543161000,0.14653208163369430000,0.44926635774213253000,-0.21417598566615748000,0.28297453982822895000,-0.49763984864099864000,0.23359892419663350000,0.47666555031089697000,-0.23076599634697162000,
		0.17931353421598253000,-0.31403890105913690000,0.14698223553140688000,0.45067529964608133000,-0.21533137044797102000,0.22647742270201213000,-0.43072854542866729000,0.20740873742611843000,0.47686931543408906000,-0.23105456263063270000,
		0.16503436301639851000,-0.28778844507336238000,0.13428637524618453000,0.45203417008311453000,-0.21644861249677441000,0.22093873463080102000,-0.42008071229816357000,0.20214268282001896000,0.47707882280192793000,-0.23134797021927864000,
		0.15190169316393992000,-0.26370172133513659000,0.12265881775959593000,0.45334481181405800000,-0.21752885851325893000,0.21552835440097115000,-0.40969396435671179000,0.19701478146204870000,0.47729337809296091000,-0.23164548803461404000,
		0.13982427536119696000,-0.24160380040142596000,0.11201220709188885000,0.45460900819870653000,-0.21857324297066089000,0.21024238672769491000,-0.39956063178935625000,0.19202116576946329000,0.47751232193978388000,-0.23194642357840448000,
		0.12871741092582561000,-0.22133257018873845000,0.10226567447811812000,0.45582848324353864000,-0.21958288485962515000,0.20507794498885856000,-0.38967492613981231000,0.18715885582340450000,0.47773502999375339000,-0.23225012277080340000,
		0.11850296518949681000,-0.20273865359770421000,0.09334476043442747900,0.45700490199237165000,-0.22055888496806755000,0.20003248760176731000,-0.38003167350336858000,0.18242514617542843000,0.47796091268245133000,-0.23255596949280694000,
		0.13522421007794000000,-0.25687682863763184000,0.12324333186398555000,0.45813987120226018000,-0.22150232363780317000,0.15742418320108537000,-0.26790875229142952000,0.12290052596842664000,0.47818941471431864000,-0.23286338488771957000,
		// 2500Hz band
		0.04878044723532087800,-0.07831277410040707300,0.03877130037547667200,0.44768655606623298000,-0.20852643765962639000,0.27749239844068330000,-0.50000000000000000000,0.24171646894200871000,0.34148383361082613000,-0.15719017549459846000,
		0.04902247199173252700,-0.07827822107525338200,0.03865320930983581800,0.44762037719421932000,-0.20879615142311692000,0.27765788454832435000,-0.50000000000000000000,0.24123127790457469000,0.34547325057962497000,-0.15977919532830118000,
		0.17081011894325712000,-0.30741214110498533000,0.14801612343695109000,0.44758422116121782000,-0.20909631504008627000,0.31488855055915349000,-0.50000000000000000000,0.24622964278224566000,0.34934077356138848000,-0.16231573556012149000,
		0.17922076774766044000,-0.32236690148174768000,0.15490344639041193000,0.44757672370382684000,-0.20942519266882520000,0.31632113218897662000,-0.49935923515274172000,0.24522611512039261000,0.35308910166479324000,-0.16479866975842000000,
		0.18801095386208963000,-0.33799337697409265000,0.16208431317749769000,0.44759646751857474000,-0.20978101479839956000,0.30580178183813223000,-0.47984021231927920000,0.23495780736141456000,0.35672102355494872000,-0.16722713715378223000,
		0.19720159340457835000,-0.35432977131718468000,0.16957566869653470000,0.44764199988940023000,-0.21016199612275852000,0.29566105843830615000,-0.46101805779270277000,0.22506389953623387000,0.36023939529587878000,-0.16960052255965777000,
		0.20681498115749175000,-0.37141697281345809000,0.17739574162322089000,0.44771184859492608000,-0.21056635142349661000,0.28587942290221752000,-0.44285801320744150000,0.21552661546578575000,0.36364712012149947000,-0.17191843601526163000,
		0.21687502417529683000,-0.38929900412907248000,0.18556426832985456000,0.44780453603265835000,-0.21099230944887326000,0.27643871322772612000,-0.42532786290677754000,0.20632953687343950000,0.36694713019939351000,-0.17418069255646676000,
		0.22740729328540352000,-0.40802314789896127000,0.19410256262704695000,0.44791859156159658000,-0.21143812483699659000,0.26732212229947788000,-0.40839786847319215000,0.19745756259231215000,0.37014237038612963000,-0.17638729244209511000,
		0.23843916580691563000,-0.42764023966180431000,0.20303366707968284000,0.44805256211460992000,-0.21190208817611397000,0.25851405746714051000,-0.39204052125203281000,0.18889677932459389000,0.37323578392173995000,-0.17853840208989599000,
		0.25000000000000000000,-0.39904206100875445000,0.17576643359688951000,0.39904206100875445000,-0.17576643359688951000,0.25000000000000000000,-0.39904206100875445000,0.17576643359688951000,0.39904206100875445000,-0.17576643359688951000,
		0.23938317992016597000,-0.42902498836149394000,0.20290318279729083000,0.44837457618865162000,-0.21287784914926550000,0.23594166783194234000,-0.35224749341222950000,0.16849859344455670000,0.37912882290923711000,-0.18267553917121310000,
		0.22922758308848118000,-0.41070118465624700000,0.19386980131658083000,0.44855987466822062000,-0.21338647479463654000,0.22266598075135313000,-0.32967245567863102000,0.15710179785477946000,0.38193422317632864000,-0.18466257196916577000,
		0.21952245094844938000,-0.39321259718289098000,0.18527019560596295000,0.44875960891468047000,-0.21390691371158671000,0.21012256249560968000,-0.30841548519162676000,0.14639717382889850000,0.38464932962952936000,-0.18659609436058694000,
		0.21025626545828932000,-0.37653688514798522000,0.17709157872592879000,0.44897251970665775000,-0.21443773152987516000,0.19826506508697106000,-0.28839407975831483000,0.13634167962486449000,0.38727692317935725000,-0.18847685265152800000,
		0.20141640383704493000,-0.36064976729658343000,0.16932029392904399000,0.44919739896604571000,-0.21497755896504653000,0.18705126516040727000,-0.26953293860285676000,0.12689596926660071000,0.38981973161076638000,-0.19030566683775507000,
		0.19298987557968353000,-0.34552634630526385000,0.16194244777969283000,0.44943309157138273000,-0.21552509288420829000,0.17644215121864745000,-0.25176249912381099000,0.11802366328619585000,0.39228042544015262000,-0.19208341915889926000,
		0.18496285389045425000,-0.33114027260479656000,0.15494352525033658000,0.44967849643356722000,-0.21607909665987088000,0.16640216678088243000,-0.23501916633494754000,0.10969142292163270000,0.39466161468340655000,-0.19381104371955943000,
		0.17732114240450883000,-0.31746458167415653000,0.14830878982192411000,0.44993256694456762000,-0.21663839992717243000,0.15689859050002913000,-0.21924429990388811000,0.10186844050143459000,0.39696584641783261000,-0.19548951712043278000,
		0.13314118135087333000,-0.23838682326544808000,0.11119746504795892000,0.39919560303106616000,-0.19711985003710583000,0.18890213496990330000,-0.26104253843793396000,0.12073052448515727000,0.45019431089933726000,-0.21720189784724037000,
		0.12999877570040522000,-0.23279481674456406000,0.10843272638767330000,0.40135330106046202000,-0.19870307968088552000,0.17491117479877821000,-0.23891735404664041000,0.10997727305034505000,0.45046278998060618000,-0.21776854996775391000,
		// 5000Hz band
		0.15524899846180229000,-0.23293875593112637000,0.11848760486413583000,0.38252698297833709000,-0.17373076238013990000,0.31351242906971222000,-0.32122631503312910000,0.20835200367194631000,0.16558040011402253000,-0.11424186822917137000,
		0.16292547442269628000,-0.24453300996081517000,0.12367626281982134000,0.38180127515860418000,-0.17426204487134828000,0.30641493201730763000,-0.30966366567944775000,0.20090180449507106000,0.17125007419759852000,-0.11707820424597883000,
		0.17094699302274804000,-0.25666430894733916000,0.12906584136723354000,0.38112384760220008000,-0.17484453007211970000,0.29950486745273819000,-0.29837245286920117000,0.19364512898493699000,0.17678993313812497000,-0.11990950095005254000,
		0.17933179449915118000,-0.26936321096601928000,0.13466756066624949000,0.38049301293158705000,-0.17547523042690397000,0.29277289351547847000,-0.28734075532818232000,0.18657507713253044000,0.18220096033131850000,-0.12273095701789186000,
		0.18809932424021986000,-0.28266251331125342000,0.14049361347629558000,0.37990698639392684000,-0.17615112033900623000,0.28621042906821448000,-0.27655773697281233000,0.17968550195794880000,0.18748436710244593000,-0.12553813451269277000,
		0.19727029425473835000,-0.29659739605144519000,0.14655723946819024000,0.37936391227802774000,-0.17686916355372878000,0.27980961812079153000,-0.26601358229604283000,0.17297096662886705000,0.19264156232959403000,-0.12832695502820107000,
		0.20686674363992677000,-0.31120556921911779000,0.15287280345304974000,0.37886188786544628000,-0.17762633725409852000,0.27356329712353150000,-0.25569943478990198000,0.16642670331099754000,0.19767412427198561000,-0.13109369216397321000,
		0.21691212906813293000,-0.32652747060543658000,0.15945590086817815000,0.37839898480289197000,-0.17841965291250855000,0.26746492545815465000,-0.24560730179158130000,0.16004854985503023000,0.20258377475278572000,-0.13383496104617490000,
		0.22743142415504980000,-0.34260648277477990000,0.16632347475490278000,0.37797326788109253000,-0.17924617402605078000,0.26150852047844042000,-0.23572996750417630000,0.15383289129112396000,0.20737235574699664000,-0.13654770554972678000,
		0.23845124433375336000,-0.35948919467253465000,0.17349395659984124000,0.37758281128215776000,-0.18010303092399083000,0.25568858023356172000,-0.22606089921491507000,0.14777659620923855000,0.21204180834697564000,-0.13922918380860660000,
		0.25000000000000000000,-0.28519689605573634000,0.12684139527399529000,0.28519689605573634000,-0.12684139527399529000,0.25000000000000000000,-0.28519689605573634000,0.12684139527399529000,0.28519689605573634000,-0.12684139527399529000,
		0.23937105664952038000,-0.36152958603722701000,0.17244581127222866000,0.37690010349596687000,-0.18189667775124577000,0.23854893008359715000,-0.20232938605664899000,0.13285189133582173000,0.22103147802731044000,-0.14448885053279503000,
		0.22920322772087051000,-0.34653077196220677000,0.16433520657355094000,0.37660416106484340000,-0.18282815949118056000,0.22761610688255524000,-0.18880515316078209000,0.12432182856389705000,0.22535591485977097000,-0.14706298193427886000,
		0.21948486682012289000,-0.33221140313733061000,0.15664165503037869000,0.37633611362377206000,-0.18377937364914793000,0.21717247356766831000,-0.17598247787095100000,0.11626107816092103000,0.22956963550535414000,-0.14959769919445962000,
		0.21020357090790717000,-0.31855248684091192000,0.14935076151241453000,0.37609424760995358000,-0.18474792125014192000,0.20719126292807841000,-0.16382540582445815000,0.10864587056543390000,0.23367483638936135000,-0.15209158635400258000,
		0.20134626413133466000,-0.30553402593371271000,0.14244778128630886000,0.37587691189384592000,-0.18573151120124859000,0.19764786507942284000,-0.15230077408003526000,0.10145419477386847000,0.23767372980474732000,-0.15454344260085132000,
		0.19289925300193050000,-0.29313509554241274000,0.13591767811539046000,0.37568252099389199000,-0.18672796146900522000,0.18851972552634999000,-0.14137800570653813000,0.09466565864569090300,0.24156853566899417000,-0.15695226632982343000,
		0.18484838067887069000,-0.28133406920011411000,0.12974524877465976000,0.37550955718465107000,-0.18773519921879722000,0.17978614696203368000,-0.13102883452300054000,0.08826130350083902200,0.24536147445032380000,-0.15931723979995691000,
		0.17717902618541143000,-0.27010860869677944000,0.12391513428809570000,0.37535657166134728000,-0.18875126009098536000,0.17142824284699065000,-0.12122715036362279000,0.08222350019410835900,0.24905476111860161000,-0.16163771446510256000,
		0.16987658820316767000,-0.25943639198224938000,0.11841216654420736000,0.37522218490890447000,-0.18977428676830854000,0.16342842115672093000,-0.11194851699633906000,0.07653562428713754600,0.25265059998932732000,-0.16391319702699930000,
		0.16292585097456155000,-0.24929413688990845000,0.11322092920497415000,0.37510508640807516000,-0.19080252696974442000,0.15577094929628443000,-0.10317046444247939000,0.07118225705375654000,0.25615118034259932000,-0.16614333623884614000,
		///10000Hz band
		0.08587493093518809600,0.14067763041916989000,0.06001195525512304600,-0.44719422940551679000,-0.20240348519511467000,0.30839764883955895000,-0.31503609990699094000,0.11702321444458585000,0.35264709037764469000,-0.13780987019002891000,
		0.09581169274514812800,0.15672310171724532000,0.06680260057521809900,-0.44378558948445657000,-0.19967678111529685000,0.30355582693302191000,-0.30824916331376306000,0.11458932725008059000,0.34355788592743586000,-0.13283642815158636000,
		0.10686737313712906000,0.17446729330750338000,0.07428763175607461200,-0.44004648396558832000,-0.19673419559500499000,0.29855636087781462000,-0.30080213521929861000,0.11194379763878624000,0.33365525308302735000,-0.12764703600323218000,
		0.11916196909160269000,0.19403584775432059000,0.08250570457408193400,-0.43589595371568979000,-0.19352777969650142000,0.29339522648802746000,-0.29251580521731663000,0.10903830205174242000,0.32274549816612064000,-0.12220382926710573000,
		0.13282647499779324000,0.21552933642625463000,0.09147679991934401500,-0.43121230541670441000,-0.18998624402222969000,0.28806488338757968000,-0.28311881964338670000,0.10580399857487371000,0.31053725190019332000,-0.11645044085994248000,
		0.14800274901098551000,0.23898856570870303000,0.10118230089985365000,-0.42580141633954488000,-0.18599790074291372000,0.28255168978902218000,-0.27217607334010779000,0.10213916641679044000,0.29656597634179788000,-0.11030094024052571000,
		0.16484218330953018000,0.26431778741501605000,0.11152292423885504000,-0.41932765414275225000,-0.18137497466252228000,0.27683113904909679000,-0.25893232225792845000,0.09788643035737011600,0.28002999669736373000,-0.10361987464360256000,
		0.18350146071362966000,0.29109034121988109000,0.12221835030875190000,-0.41113854094301322000,-0.17576801160670952000,0.27085802115526747000,-0.24191402257638056000,0.09278831065366377500,0.25937562526372004000,-0.09618469347395415500,
		0.20412996108607509000,0.31793298612550347000,0.13251632618323045000,-0.39970075300709806000,-0.16841405668985135000,0.26454224677355004000,-0.21764204334627335000,0.08640330460285936000,0.23096523301706001000,-0.08762228456177897900,
		0.22682377853990304000,0.33950658220901370000,0.14000508104184597000,-0.37976646591311514000,-0.15708875841073311000,0.25766871502444427000,-0.17408539821530097000,0.07817779717074589700,0.18236185568821722000,-0.07756977243774829100,
		0.25000000000000000000,0.00000000000000000000,0.00000000000000000000,-0.00000000000000000000,-0.00000000000000000000,0.25000000000000000000,0.00000000000000000000,0.00000000000000000000,-0.00000000000000000000,-0.00000000000000000000,
		0.24617129047052336000,0.37395040396504575000,0.15468296950552946000,-0.37419641846466245000,-0.15431040998333470000,0.24197603707665180000,-0.17650879661351573000,0.07508010452569602300,0.16890428296542059000,-0.07585107602540072700,
		0.24379586562898545000,0.38978156428769117000,0.16423460293916536000,-0.38937570020826240000,-0.16229406682656508000,0.23568498084955433000,-0.21774014608215420000,0.08260502583574812200,0.20567796448460657000,-0.08165359754128526100,
		0.24171084309658944000,0.39750657344334916000,0.16994013709947522000,-0.39657768947429994000,-0.16650868858679618000,0.23018799734869452000,-0.23882062296208556000,0.08856224786547055300,0.22328489806630597000,-0.08564294151037306300,
		0.23981072198571005000,0.40223706995419017000,0.17398265449583733000,-0.40086490925489737000,-0.16913590016798721000,0.22522061516683364000,-0.25227411248538628000,0.09334932764296921500,0.23383597953191726000,-0.08839904236713171100,
		0.23804986324717087000,0.40544787572032148000,0.17710709934444607000,-0.40368940324710512000,-0.17091287421347756000,0.22066040318045393000,-0.26176147163674468000,0.09735619977863034500,0.24081971828175841000,-0.09037210721784816300,
		0.23640331555294425000,0.40776007483095089000,0.17965351198522322000,-0.40565959540414581000,-0.17217350667640599000,0.21643699989461038000,-0.26884700462717892000,0.10081673622452272000,0.24570750894205795000,-0.09182306198749556900,
		0.23485557636167420000,0.40949038177447994000,0.18180431297046781000,-0.40708425941912835000,-0.17309571418431702000,0.21250465286049228000,-0.27433968020031235000,0.10387552926651664000,0.24925065134729868000,-0.09291076695158151400,
		0.23339613070492718000,0.41082058675150451000,0.18366800011688192000,-0.40813975347656439000,-0.17378463972523922000,0.20883097685112467000,-0.27871020973135180000,0.10662662088282290000,0.25188052796369975000,-0.09373757546954431000,
		0.23201734211988442000,0.41186381177315945000,0.18531390414970081000,-0.40893521768297381000,-0.17430701478395766000,0.20539151594986813000,-0.28225550002867178000,0.10913390140568026000,0.25386529920061207000,-0.09437253141196019800,
		0.23071333101978869000,0.41269468111589708000,0.18678872911751734000,-0.40954219376706913000,-0.17470743382727016000,0.20216682282440818000,-0.28517416735968115000,0.11144233444064895000,0.25538140538069198000,-0.09486389964784250300,
*/
};
/*******************************************************************************
 *******************************************************************************
                        GLOBAL FUNCTION DEFINITIONS
 *******************************************************************************
 ******************************************************************************/

/**
 * @brief Initialize equalizer.
 * 
 */
void equalizer_init(void)
{
	//arm_float_to_q31(FloatcoeffTable, coeffTable,NUMBER_OF_BANDS * COEF_PER_FILTER * GAIN_LEVELS);
    /* Initialize the state and coefficient buffers for all Biquad sections all gains set to 0 on setup*/

        arm_biquad_cas_df1_32x64_init_q31(&S1, NUMBER_OF_STAGES,
            (q31_t *) &coeffTable[COEF_PER_FILTER*GAIN_LEVELS*0 + COEF_PER_FILTER*(DEFAULT_GAIN + MAX_GAIN)],
            &biquadStateBandQ63[0][0], 2);

        arm_biquad_cas_df1_32x64_init_q31(&S2, NUMBER_OF_STAGES,
            (q31_t *) &coeffTable[COEF_PER_FILTER*GAIN_LEVELS*1 + COEF_PER_FILTER*(DEFAULT_GAIN + MAX_GAIN)],
            &biquadStateBandQ63[1][0], 2);

         arm_biquad_cascade_df1_init_q31(&S3, NUMBER_OF_STAGES,
          (q31_t *) &coeffTable[COEF_PER_FILTER*GAIN_LEVELS*2 + COEF_PER_FILTER*(DEFAULT_GAIN + MAX_GAIN)],
          &biquadStateBandQ31[0][0], 2);

        arm_biquad_cascade_df1_init_q31(&S4, NUMBER_OF_STAGES,
          (q31_t *) &coeffTable[COEF_PER_FILTER*GAIN_LEVELS*3 + COEF_PER_FILTER*(DEFAULT_GAIN + MAX_GAIN)],
          &biquadStateBandQ31[1][0], 2);

         arm_biquad_cascade_df1_init_q31(&S5, NUMBER_OF_STAGES,
          (q31_t *) &coeffTable[COEF_PER_FILTER*GAIN_LEVELS*4 + COEF_PER_FILTER*(DEFAULT_GAIN + MAX_GAIN)],
          &biquadStateBandQ31[2][0], 2);

        arm_biquad_cascade_df1_init_q31(&S6, NUMBER_OF_STAGES,
          (q31_t *) &coeffTable[COEF_PER_FILTER*GAIN_LEVELS*5 + COEF_PER_FILTER*(DEFAULT_GAIN + MAX_GAIN)],
          &biquadStateBandQ31[3][0], 2);

         arm_biquad_cascade_df1_init_q31(&S7, NUMBER_OF_STAGES,
          (q31_t *) &coeffTable[COEF_PER_FILTER*GAIN_LEVELS*6 + COEF_PER_FILTER*(DEFAULT_GAIN + MAX_GAIN)],
          &biquadStateBandQ31[4][0], 2);

        arm_biquad_cascade_df1_init_q31(&S8, NUMBER_OF_STAGES,
          (q31_t *) &coeffTable[COEF_PER_FILTER*GAIN_LEVELS*7 + COEF_PER_FILTER*(DEFAULT_GAIN + MAX_GAIN)],
          &biquadStateBandQ31[5][0], 2);

  
}

/**
 * @brief Sets  equalizer filter gains.
 * @param gain  number in dB with the desired gain of the filter
 * @param band selected band in which to change gain (between 1 and NUMBER_OF_BANDS)
 */


void equalizer_set_band_gain (int32_t band, int32_t gain)
{
    if(band < 3 )
    {
         arm_biquad_cas_df1_32x64_init_q31(hpFilter[band - 1], NUMBER_OF_STAGES,
            (q31_t *) &coeffTable[COEF_PER_FILTER*GAIN_LEVELS*(band-1) + COEF_PER_FILTER*(gain + MAX_GAIN)],
            &biquadStateBandQ63[band - 1][0], 2);
    }
    else
    {
         arm_biquad_cascade_df1_init_q31(lpFilter[band - 3], NUMBER_OF_STAGES,
          (q31_t *) &coeffTable[COEF_PER_FILTER*GAIN_LEVELS*(band-1) + COEF_PER_FILTER*(gain + MAX_GAIN)],
          &biquadStateBandQ31[band - 3][0], 2);
    }
	bandGains[band-1] = gain;
}

/**
 * @brief returns equalizer filter gains.
 * @return gain  number in dB 
 * @param band selected band in which to change gain (between 1 and NUMBER_OF_BANDS)
 */
int32_t equalizer_get_band_gain (int32_t band)
{
	return bandGains[band-1];
}

/**
 * @brief Applies the filter to the data in inputF32 and stores the result in outputF32
 * @param inputF32  pointer to an array of size FRAME_SIZE with input data
 * @param outputF32 pointer to an array of size FRAME_SIZE //!(will be overwritten)
 */
void equalizer_equalize(float32_t* inputF32, float32_t * outputF32)
{
    
    /* ----------------------------------------------------------------------
    ** Q31 input and output buffers
    ** ------------------------------------------------------------------- */

    q31_t inputQ31[BLOCKSIZE];
    q31_t outputQ31[BLOCKSIZE];

    for(int i=0; i < NUMBER_OF_BLOCKS; i++)
  {

    /* ----------------------------------------------------------------------
    ** Convert block of input data from float to Q31
    ** ------------------------------------------------------------------- */

    arm_float_to_q31(inputF32 + (i*BLOCKSIZE), inputQ31, BLOCKSIZE);

    /* ----------------------------------------------------------------------
    ** Scale down by 1/8.  This provides additional headroom so that the
    ** graphic EQ can apply gain.
    ** ------------------------------------------------------------------- */

    arm_scale_q31(inputQ31, 0x7FFFFFFF, -3, inputQ31, BLOCKSIZE);

    /* ----------------------------------------------------------------------
    ** Call the Q31 Biquad Cascade DF1 32x64 process function for band1, band2
    ** ------------------------------------------------------------------- */

    arm_biquad_cas_df1_32x64_q31(&S1, inputQ31, outputQ31, BLOCKSIZE);
    arm_biquad_cas_df1_32x64_q31(&S2, outputQ31, outputQ31, BLOCKSIZE);

    /* ----------------------------------------------------------------------
    ** Call the Q31 Biquad Cascade DF1 process function for band3, band4, band5, band6, band7, band8
    ** ------------------------------------------------------------------- */

    arm_biquad_cascade_df1_fast_q31(&S3, outputQ31, outputQ31, BLOCKSIZE);
    arm_biquad_cascade_df1_fast_q31(&S4, outputQ31, outputQ31, BLOCKSIZE);
    arm_biquad_cascade_df1_fast_q31(&S5, outputQ31, outputQ31, BLOCKSIZE);
    arm_biquad_cascade_df1_fast_q31(&S6, outputQ31, outputQ31, BLOCKSIZE);
    arm_biquad_cascade_df1_fast_q31(&S7, outputQ31, outputQ31, BLOCKSIZE);
    arm_biquad_cascade_df1_fast_q31(&S8, outputQ31, outputQ31, BLOCKSIZE);

    /* ----------------------------------------------------------------------
    ** Convert Q31 result back to float
    ** ------------------------------------------------------------------- */

    arm_q31_to_float(outputQ31, outputF32 + (i * BLOCKSIZE), BLOCKSIZE);

    /* ----------------------------------------------------------------------
    ** Scale back up
    ** ------------------------------------------------------------------- */

    arm_scale_f32(outputF32 + (i * BLOCKSIZE), 8.0f, outputF32 + (i * BLOCKSIZE), BLOCKSIZE);
  };
}
